<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–°–≤–∞–¥–µ–±–Ω–æ–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ ‚Äî –≤—ã–±–æ—Ä –≤–µ—Ä—Å–∏–∏</title>
    <style>
        :root {
            --bg: #f7f7fb;
            --card: #fff;
            --text: #222;
            --muted: #666;
            --accent: #7c3aed;
            --accent2: #4f46e5;
            --shadow: 0 10px 30px rgba(0,0,0,.08)
        }

        * {
            box-sizing: border-box
        }

        body {
            margin: 0;
            min-height: 100svh;
            display: grid;
            place-items: center;
            padding: 2rem;
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans";
            color: var(--text);
            background: linear-gradient(180deg,#f7f7fb,#ececf7)
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 520px;
            padding: 2rem
        }

        h1 {
            margin: 0 0 .5rem;
            font-size: 1.6rem
        }

        p {
            margin: .25rem 0 1rem;
            color: var(--muted)
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: .5rem
        }

        input[type="date"], input[type="text"] {
            width: 100%;
            padding: .75rem 1rem;
            font-size: 1rem;
            border: 1px solid #ddd;
            border-radius: 12px;
            outline: none;
            background: #fafafa;
            transition: .2s border-color,.2s box-shadow
        }

            input[type="date"]:focus {
                border-color: var(--accent2);
                box-shadow: 0 0 0 3px rgba(99,102,241,.16)
            }

        button {
            margin-top: 1rem;
            width: 100%;
            padding: .9rem 1rem;
            font-size: 1rem;
            font-weight: 700;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg,var(--accent),var(--accent2));
            color: #fff;
            cursor: pointer;
            transition: transform .06s, opacity .2s
        }

            button:hover {
                opacity: .96
            }

            button:active {
                transform: scale(.99)
            }

        .error {
            color: #b91c1c;
            font-size: .95rem;
            display: none;
            margin-top: .5rem
        }

        .footer {
            margin-top: 1rem;
            font-size: .9rem;
            color: var(--muted);
            text-align: center
        }

        .modal {
            position: fixed;
            inset: 0;
            display: none;
            place-items: center;
            padding: 1rem;
            background: rgba(0,0,0,.4)
        }

            .modal.open {
                display: grid
            }

        .modal-box {
            background: #fff;
            border-radius: 16px;
            box-shadow: var(--shadow);
            max-width: 460px;
            width: 100%;
            padding: 1.25rem
        }

        .modal h2 {
            margin: .25rem 0 .5rem;
            font-size: 1.25rem
        }

        .modal p {
            margin: 0 0 .75rem
        }

        .modal .row {
            display: flex;
            gap: .75rem
        }
    
        .notice {
            margin-top: 1rem;
            padding: .75rem 1rem;
            background: #fff7ed;
            border: 1px dashed #fb923c;
            border-radius: 12px;
        }
        .notice-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }
        .notice-text {
            font-size: .95rem;
            line-height: 1.35;
        }
        .notice input[type="checkbox"] {
            width: 22px;
            height: 22px;
            accent-color: #ea580c;
            cursor: pointer;
        }

    </style>
</head>
<body>
    <main class="card" role="main">
        <h1>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞ —Å–≤–∞–¥—å–±—É</h1>
        <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É —Å–≤–æ–µ–≥–æ —Ä–æ–∂–¥–µ–Ω–∏—è, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –ø–æ–¥—Ö–æ–¥—è—â—É—é –≤–µ—Ä—Å–∏—é —Å–∞–π—Ç–∞.</p>

        <form id="ageForm" novalidate>
            <label for="lastName">–§–∞–º–∏–ª–∏—è</label>
<input type="text" id="lastName" name="lastName" autocomplete="family-name" required />
<label for="firstName">–ò–º—è</label>
<input type="text" id="firstName" name="firstName" autocomplete="given-name" required />
<label for="dob">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
            <input type="date" id="dob" name="dob" required />
            <div id="err" class="error" role="alert"></div>
            <button type="submit">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </form>


        <div class="notice" role="note" aria-label="–í–∞–∂–Ω–∞—è –ø–æ–º–µ—Ç–∫–∞">
            <div class="notice-row">
                <div class="notice-text"><strong>–í–ù–ò–ú–ê–ù–ò–ï!!!</strong> –ï—Å–ª–∏ –≤—ã ‚Äî –ø–∞–ø–∞ –æ–¥–Ω–æ–≥–æ –∏–∑ –º–æ–ª–æ–¥–æ–∂—ë–Ω–æ–≤, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É –Ω–∞–ø—Ä–æ—Ç–∏–≤</div>
                <input type="checkbox" id="isDad" aria-label="–Ø –ø–∞–ø–∞ –æ–¥–Ω–æ–≥–æ –∏–∑ –º–æ–ª–æ–¥–æ–∂—ë–Ω–æ–≤" />
            </div>
        </div>

        <div class="footer">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (localStorage). –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –Ω–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –Ω–∏–∫—É–¥–∞.</div>
    </main>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–æ–≤–Ω–æ 30 –ª–µ—Ç -->
    <div id="tieModal" class="modal" aria-hidden="true" aria-labelledby="tieTitle" role="dialog">
        <div class="modal-box">
            <h2 id="tieTitle">–í–∞–º —Ä–æ–≤–Ω–æ 30 –ª–µ—Ç üéâ</h2>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ, –∫–∞–∫—É—é –≤–µ—Ä—Å–∏—é —Å–∞–π—Ç–∞ –æ—Ç–∫—Ä—ã—Ç—å:</p>
            <div class="row">
                <button id="goYoung" type="button">–ú–æ–ª–æ–¥—ë–∂–Ω–∞—è</button>
                <button id="goOld" type="button">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è</button>
            </div>
        </div>
    </div>

    <script>
        (function () {
            const dobEl = document.getElementById('dob');
            const firstNameEl = document.getElementById('firstName');
            const lastNameEl  = document.getElementById('lastName');
            const form = document.getElementById('ageForm');
            const err = document.getElementById('err');
            const modal = document.getElementById('tieModal');
            const goYoung = document.getElementById('goYoung');
            const goOld = document.getElementById('goOld');
            const isDad = document.getElementById('isDad');
            const dadUrl = 'https://avatars.mds.yandex.net/i?id=030eef689d9b10561d93210bae98da4923f6e616-10879920-images-thumbs&n=13';

            // –£—Å—Ç–∞–Ω–æ–≤–∏–º –¥–æ–ø—É—Å—Ç–∏–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
            function todayYMD() {
                const now = new Date();
                const y = now.getFullYear();
                const m = String(now.getMonth() + 1).padStart(2, '0');
                const d = String(now.getDate()).padStart(2, '0');
                return `${y}-${m}-${d}`;
            }
            dobEl.max = todayYMD();
            dobEl.min = '1900-01-01';
            setTimeout(() => (firstNameEl.value ? dobEl.focus() : (lastNameEl.focus())), 50);

            // Prefill
            try {
                const savedFirst = localStorage.getItem('guestFirstName');
                const savedLast  = localStorage.getItem('guestLastName');
                if (savedFirst) firstNameEl.value = savedFirst;
                if (savedLast)  lastNameEl.value  = savedLast;
            } catch (e) {}


            function parseDate(ymd) {
                // –†–∞–∑–±–∏—Ä–∞–µ–º YYYY-MM-DD –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç Date (–±–µ–∑ —Å–º–µ—â–µ–Ω–∏—è —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞)
                const [y, m, d] = ymd.split('-').map(Number);
                return new Date(y, (m || 1) - 1, d || 1);
            }

            function calcAge(birth) {
                const now = new Date();
                let age = now.getFullYear() - birth.getFullYear();
                const mon = now.getMonth() - birth.getMonth();
                if (mon < 0 || (mon === 0 && now.getDate() < birth.getDate())) age--;
                return age;
            }

            function showError(message) {
                err.textContent = message; err.style.display = 'block';
            }
            function clearError() {
                err.textContent = ''; err.style.display = 'none';
            }

            form.addEventListener('submit', function (e) {
                e.preventDefault();
                clearError();
                const f = (firstNameEl.value || '').trim();
                const l = (lastNameEl.value || '').trim();
                if (!l) { showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é.'); lastNameEl.focus(); return; }
                if (!f) { showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∏–º—è.'); firstNameEl.focus(); return; }
                try { localStorage.setItem('guestFirstName', f); localStorage.setItem('guestLastName', l); } catch (e) {}

                const value = dobEl.value.trim();
                if (!value) { showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É.'); dobEl.focus(); return; }
                if (!/^\d{4}-\d{2}-\d{2}$/.test(value)) { showError('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ì–ì–ì–ì-–ú–ú-–î–î.'); return; }

                const birth = parseDate(value);
                if (Number.isNaN(birth.getTime())) { showError('–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –¥–∞—Ç—É.'); return; }
                const today = new Date();
                if (birth > today) { showError('–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –±—É–¥—É—â–µ–º.'); return; }
                if (birth.getFullYear() < 1900) { showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é –¥–∞—Ç—É (–Ω–µ —Ä–∞–Ω–µ–µ 1900 –≥–æ–¥–∞).'); return; }

                const age = calcAge(birth);
                if (isDad && isDad.checked) { window.location.href = dadUrl; return; }
if (age > 30) {
                    window.location.href = 'index_old.html';
                } else if (age < 30) {
                    window.location.href = 'index_yng.html';
                } else {
                    // –†–æ–≤–Ω–æ 30 ‚Äî –¥–∞—ë–º –≤—ã–±—Ä–∞—Ç—å
                    modal.classList.add('open');
                    modal.setAttribute('aria-hidden', 'false');
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –ø–æ –∫–ª–∏–∫—É —Å–Ω–∞—Ä—É–∂–∏
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('open');
                    modal.setAttribute('aria-hidden', 'true');
                }
            });
            // –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞
            goYoung.addEventListener('click', () => { if (isDad && isDad.checked) { window.location.href = dadUrl; } else { window.location.href = 'index_yng.html'; } });
            goOld.addEventListener('click', () => { if (isDad && isDad.checked) { window.location.href = dadUrl; } else { window.location.href = 'index_old.html'; } });
        })();
    </script>
</body>
</html>
